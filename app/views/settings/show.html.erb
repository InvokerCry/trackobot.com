<div class="container">
  <%= render '/layouts/header' %>

  <div>
    <h2>Settings</h2>

    <h3>API</h3>

    <div class="alert alert-info">
      <p>
        The API allows you or third party websites and tools to access your Track-o-Bot data.
        You can access any profile page by providing the <code>username</code> and <code>token</code> in the URL.
      </p>

      <p>
        For example: <pre>https://trackobot.com/profile/results.json?username=<%= current_user.username %>&amp;token=YOUR_API_TOKEN</pre>
      </p>
    </div>

    <%= form_tag profile_settings_path, method: :put, class: 'form-horizontal', role: 'form' do %>
      <div class="form-group">
        <label class="col-sm-4 control-label"><code>username</code></label>
        <div class="col-sm-8">
          <p class="form-control-static"><%= current_user.username %></p>
        </div>
      </div>
      <div class="form-group">
        <label class="col-sm-4 control-label"><code>token</code></label>
        <div class="col-sm-8">
          <input type="text" id="api_token" class="form-control" placeholder="(hidden)" data-token="<%= current_user.api_authentication_token %>">
        </div>
      </div>

      <div class="form-group">
        <div class="col-sm-offset-4 col-sm-8">
          <a class="btn btn-primary btn-xs" name="reveal_api_token" id="reveal_api_token">Reveal</a>
          <button type="submit" name="regenerate_api_token" id="regenerate_api_token" class="btn btn-danger btn-xs" value="1" 
            onclick="return confirm('Are you sure you want to change your API Token? Websites and tools with your API token will not be able to retrieve your data anymore!')">Regenerate</button>
        </div>
      </div>
    <% end %>

    <%= render partial: 'layouts/profile_footer', locals: {json: true, csv: true} %>
  </div>
</div>

