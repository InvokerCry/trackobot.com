<%
  card_histories_by_card = card_histories.group_by(&:card).sort_by { |card, _| card.mana || -1 }
%>
<table class="card_history">
  <% card_histories_by_card.each do |card, card_histories| %>
  <tr>
    <td><div class="mana"><%= card.mana || 0 %></div>&nbsp;<%= card.name %> <%= "(#{card_histories.length})" if card_histories.count > 1 %></td>
  </tr>
  <% end %>
</table>
